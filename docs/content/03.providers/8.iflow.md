---
title: iFlow
description: iFlow Provider 配置（OAuth 和 Cookie）
navigation:
  icon: i-heroicons-arrow-path
---

# iFlow Provider

iFlow Provider 支持两种认证方式：OAuth 和 Cookie。

## 概述

iFlow 是一个 AI 服务提供商，ProxyCast 支持通过 OAuth 或 Cookie 方式使用其服务。

## 认证方式

### OAuth 认证

通过 OAuth 协议认证，支持自动刷新 Token。

### Cookie 认证

通过导入浏览器 Cookie 认证，适用于不支持 OAuth 的场景。

## 配置

### OAuth 模式

```yaml
credential_pool:
  iflow:
    - id: "iflow-oauth"
      token_file: "iflow/oauth.json"
      auth_type: "oauth"
      disabled: false
      proxy_url: "http://proxy:8080"  # 可选
```

### Cookie 模式

```yaml
credential_pool:
  iflow:
    - id: "iflow-cookie"
      auth_type: "cookie"
      cookies: "session_id=abc123; auth_token=xyz789"
      disabled: false
      proxy_url: "http://proxy:8080"  # 可选
```

### 配置项说明

| 配置项 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| id | string | ✅ | 凭证唯一标识 |
| auth_type | string | ✅ | 认证类型：`oauth` 或 `cookie` |
| token_file | string | OAuth | Token 文件路径（OAuth 模式必填） |
| cookies | string | Cookie | Cookie 字符串（Cookie 模式必填） |
| disabled | boolean | ❌ | 是否禁用此凭证 |
| proxy_url | string | ❌ | 单独的代理 URL |

## OAuth 登录

### 通过 UI 登录

1. 打开 ProxyCast
2. 进入 Provider 管理页面
3. 找到 iFlow 部分
4. 点击"OAuth 登录"按钮
5. 在弹出的浏览器中完成认证
6. 认证成功后自动保存凭证

### Token 文件格式

```json
{
  "access_token": "eyJ...",
  "refresh_token": "eyJ...",
  "expires_at": "2025-01-01T00:00:00Z"
}
```

## Cookie 导入

### 获取 Cookie

1. 在浏览器中登录 iFlow
2. 打开开发者工具（F12）
3. 切换到 Network 标签
4. 刷新页面
5. 选择任意请求，查看 Request Headers
6. 复制 Cookie 头的值

### 通过 UI 导入

1. 打开 ProxyCast
2. 进入 Provider 管理页面
3. 找到 iFlow 部分
4. 选择"Cookie 导入"
5. 粘贴 Cookie 字符串
6. 点击"保存"

### Cookie 格式

```
session_id=abc123; auth_token=xyz789; user_id=12345
```

## 使用示例

### API 请求

```bash
curl http://127.0.0.1:8999/v1/chat/completions \
  -H "Authorization: Bearer your-api-key" \
  -H "Content-Type: application/json" \
  -d '{
    "model": "iflow-model",
    "messages": [{"role": "user", "content": "Hello!"}]
  }'
```

### 路由配置

将 iFlow 模型路由到 iFlow Provider：

```yaml
routing:
  rules:
    - pattern: "iflow-*"
      provider: "iflow"
      priority: 1
```

## 多账号配置

```yaml
credential_pool:
  iflow:
    # OAuth 账号
    - id: "iflow-oauth-1"
      token_file: "iflow/account1.json"
      auth_type: "oauth"
    # Cookie 账号
    - id: "iflow-cookie-1"
      auth_type: "cookie"
      cookies: "session_id=abc123"
```

## 故障排除

### OAuth Token 刷新失败

1. 检查网络连接
2. 确认 OAuth 授权未被撤销
3. 尝试重新登录

### Cookie 过期

1. 重新从浏览器获取 Cookie
2. 更新配置中的 Cookie 字符串
3. Cookie 通常有效期较短，建议使用 OAuth

### 凭证无效

1. 检查账号状态
2. 确认服务可用
3. 尝试重新认证
