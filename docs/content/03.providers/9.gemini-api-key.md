---
title: Gemini API Key
description: Gemini API Key 多账号负载均衡配置
navigation:
  icon: i-heroicons-key
---

# Gemini API Key Provider

使用 API Key 访问 Google Gemini 服务，支持多账号负载均衡和模型排除。

## 概述

Gemini API Key Provider 允许你：
- 配置多个 API Key 实现负载均衡
- 为每个 Key 设置排除的模型
- 自定义 Base URL
- 为每个 Key 单独配置代理

## 支持的模型

- Gemini 2.5 Pro
- Gemini 2.5 Flash
- Gemini 2.0 系列
- Gemini 1.5 系列
- 其他 Gemini API 支持的模型

## 配置

### 基础配置

```yaml
credential_pool:
  gemini_api_keys:
    - id: "gemini-key-1"
      api_key: "AIzaSy..."
      disabled: false
```

### 完整配置

```yaml
credential_pool:
  gemini_api_keys:
    - id: "gemini-key-1"
      api_key: "AIzaSy...01"
      base_url: "https://generativelanguage.googleapis.com"
      proxy_url: "socks5://proxy1:1080"
      excluded_models:
        - "gemini-2.5-pro"
        - "gemini-2.5-*"
        - "*-preview"
      disabled: false
    - id: "gemini-key-2"
      api_key: "AIzaSy...02"
      disabled: false
```

### 配置项说明

| 配置项 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| id | string | ✅ | 凭证唯一标识 |
| api_key | string | ✅ | Gemini API Key |
| base_url | string | ❌ | 自定义 Base URL |
| proxy_url | string | ❌ | 单独的代理 URL |
| excluded_models | array | ❌ | 排除的模型列表 |
| disabled | boolean | ❌ | 是否禁用此凭证 |

## 模型排除

### 排除规则

支持以下匹配模式：

| 模式 | 说明 | 示例 |
|------|------|------|
| 精确匹配 | 完全匹配模型名称 | `gemini-2.5-pro` |
| 前缀匹配 | 以指定前缀开头 | `gemini-2.5-*` |
| 后缀匹配 | 以指定后缀结尾 | `*-preview` |
| 包含匹配 | 包含指定字符串 | `*flash*` |

### 配置示例

```yaml
excluded_models:
  - "gemini-2.5-pro"      # 精确匹配
  - "gemini-2.5-*"        # 匹配 gemini-2.5-flash, gemini-2.5-pro 等
  - "*-preview"           # 匹配所有预览版模型
  - "*flash*"             # 匹配所有包含 flash 的模型
```

### 使用场景

1. **配额限制**：某些 Key 对特定模型有配额限制
2. **区域限制**：某些 Key 在特定区域无法访问某些模型
3. **成本控制**：限制高成本模型的使用

## 负载均衡

### 工作原理

1. 收到请求时，检查请求的模型
2. 过滤掉排除了该模型的 Key
3. 在剩余的 Key 中使用 Round-Robin 选择
4. 如果选中的 Key 失败，尝试下一个

### 配置示例

```yaml
credential_pool:
  gemini_api_keys:
    # Key 1: 用于所有模型
    - id: "gemini-all"
      api_key: "AIzaSy...01"
    # Key 2: 排除 Pro 模型
    - id: "gemini-flash-only"
      api_key: "AIzaSy...02"
      excluded_models:
        - "gemini-*-pro*"
    # Key 3: 仅用于预览模型
    - id: "gemini-preview"
      api_key: "AIzaSy...03"
      excluded_models:
        - "gemini-2.5-pro"
        - "gemini-2.5-flash"
```

## 自定义 Base URL

### 使用场景

- 使用代理服务
- 使用私有部署
- 使用第三方兼容服务

### 配置示例

```yaml
credential_pool:
  gemini_api_keys:
    - id: "gemini-proxy"
      api_key: "AIzaSy..."
      base_url: "https://my-proxy.example.com/gemini"
```

## 使用示例

### API 请求

```bash
curl http://127.0.0.1:8999/v1/chat/completions \
  -H "Authorization: Bearer your-api-key" \
  -H "Content-Type: application/json" \
  -d '{
    "model": "gemini-2.5-flash",
    "messages": [{"role": "user", "content": "Hello!"}]
  }'
```

### 路由配置

将 Gemini 模型路由到 Gemini API Key Provider：

```yaml
routing:
  rules:
    - pattern: "gemini-*"
      provider: "gemini_api_key"
      priority: 1
```

## 获取 API Key

1. 访问 [Google AI Studio](https://aistudio.google.com/)
2. 登录 Google 账号
3. 点击"Get API Key"
4. 创建新的 API Key
5. 复制并保存 Key

## 故障排除

### API Key 无效

1. 确认 Key 格式正确（以 `AIzaSy` 开头）
2. 检查 Key 是否已被撤销
3. 确认账号状态正常

### 模型不可用

1. 检查模型名称是否正确
2. 确认 Key 有权访问该模型
3. 检查是否被排除规则过滤

### 配额超限

1. 等待配额重置
2. 添加更多 API Key
3. 启用配额超限自动切换
